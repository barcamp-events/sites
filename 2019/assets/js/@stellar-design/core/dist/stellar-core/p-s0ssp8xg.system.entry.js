var __awaiter=this&&this.__awaiter||function(t,e,i,s){function r(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,n){function a(t){try{o(s.next(t))}catch(t){n(t)}}function l(t){try{o(s["throw"](t))}catch(t){n(t)}}function o(t){t.done?i(t.value):r(t.value).then(a,l)}o((s=s.apply(t,e||[])).next())}))};var __generator=this&&this.__generator||function(t,e){var i={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},s,r,n,a;return a={next:l(0),throw:l(1),return:l(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(t){return function(e){return o([t,e])}}function o(a){if(s)throw new TypeError("Generator is already executing.");while(i)try{if(s=1,r&&(n=a[0]&2?r["return"]:a[0]?r["throw"]||((n=r["return"])&&n.call(r),0):r.next)&&!(n=n.call(r,a[1])).done)return n;if(r=0,n)a=[a[0]&2,n.value];switch(a[0]){case 0:case 1:n=a;break;case 4:i.label++;return{value:a[1],done:false};case 5:i.label++;r=a[1];a=[0];continue;case 7:a=i.ops.pop();i.trys.pop();continue;default:if(!(n=i.trys,n=n.length>0&&n[n.length-1])&&(a[0]===6||a[0]===2)){i=0;continue}if(a[0]===3&&(!n||a[1]>n[0]&&a[1]<n[3])){i.label=a[1];break}if(a[0]===6&&i.label<n[1]){i.label=n[1];n=a;break}if(n&&i.label<n[2]){i.label=n[2];i.ops.push(a);break}if(n[2])i.ops.pop();i.trys.pop();continue}a=e.call(t,i)}catch(t){a=[6,t];r=0}finally{s=n=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};System.register(["./p-94e3dad1.system.js","./p-5cf15a0c.system.js","./p-752b9e3e.system.js","./p-fdba8b89.system.js","./p-bd9c4de0.system.js","./p-49be6f75.system.js","./p-c4dffc26.system.js","./p-69f4f799.system.js"],(function(t){"use strict";var e,i,s,r,n,a;return{setters:[function(t){e=t.r;i=t.e;s=t.h;r=t.g},function(t){n=t.a},function(){},function(){},function(){},function(){},function(){},function(t){a=t.T}],execute:function(){var l=t("stellar_playlist",function(){function t(t){e(this,t);this.visualizationColor="gray";this.visualizationType="bars";this.autoplay=false;this.playlist="show";this.name="Playlist";this.remember=true;this.artwork=false;this.view="playlist";this.playing=false;this.load=false;this.loading=false;this.dark=false;this.current=0;this.currentTrack={title:"Loading...",artist:"One sec...",picture:undefined};this.progress_value=0;this.load_songs=i(this,"load_songs",7)}t.prototype.componentWillLoad=function(){this.loadFromStorage()};t.prototype.componentDidLoad=function(){this.visualizer=this.element.shadowRoot.querySelector("web-audio-visualizer");this.audio=this.element.shadowRoot.querySelector("audio");this.progress=this.element.shadowRoot.querySelector("progress");this.playlistItems=this.element.querySelectorAll("stellar-song");this.currentPlaylistItem=this.element.querySelector("stellar-song[playing]");var t=Array.from(this.playlistItems);t.forEach((function(t,e){t.setIndex(e)}));if(this.audio){this.audio.volume=.7}var e=this.element.querySelector("stellar-song[playing]")||this.element.querySelector("stellar-song");e.playing=true;this.prepare(e);if(this.autoplay){this.play()}if(this.remember){this.loadFromStorage()}this.handleUpdates();this.handleProgressClick()};t.prototype.cycleVisualizations=function(){if(this.visualizationType==="circle"){this.visualizationType="bars"}else if(this.visualizationType==="bars"){this.visualizationType="bars2"}else if(this.visualizationType==="bars2"){this.visualizationType="wave"}else if(this.visualizationType==="wave"){this.visualizationType="circle"}};t.prototype.handleProgressClick=function(){var t=this;this.progress.addEventListener("click",(function(e){var i=e.offsetX;var s=i/t.progress.offsetWidth;t.audio.currentTime=s*t.audio.duration}))};t.prototype.handleUpdates=function(){var t=this;this.audio.addEventListener("update",(function(){t.currentTime=n(parseFloat(t.audio.currentTime.toString()).toFixed(10));t.duration=n(parseFloat(t.audio.duration.toString()).toFixed(10));var e=t.audio.currentTime!==0&&t.audio.duration!==0?t.audio.currentTime/t.audio.duration*100:0;t.progress_value=e}));this.audio.addEventListener("ended",this.next.bind(this))};t.prototype.handleKeydown=function(t){if(t.key==="space"){this.pause()}else if(t.key==="left"){this.previous()}else if(t.key==="right"){this.next()}};t.prototype.handleSongLoaded=function(t){return __awaiter(this,void 0,void 0,(function(){var e;return __generator(this,(function(i){switch(i.label){case 0:e=t.detail.el;if(!e.playing)return[3,3];return[4,this.prepare(e)];case 1:i.sent();return[4,this.play(true)];case 2:i.sent();i.label=3;case 3:return[2]}}))}))};t.prototype.loadFromStorage=function(){var t=localStorage.getItem("playlist");if(t==="show"||t==="hide"){this.playlist=t}};t.prototype.prepare=function(t){return __awaiter(this,void 0,void 0,(function(){var e,i;return __generator(this,(function(s){switch(s.label){case 0:if(this.currentPlaylistItem){this.currentPlaylistItem.switching()}this.currentTrack={title:"Loading...",artist:"One sec...",picture:undefined};this.currentPlaylistItem=t;this.audio.src=this.currentPlaylistItem.src;return[4,this.audio.load()];case 1:s.sent();e=this;return[4,this.currentPlaylistItem.getIndex()];case 2:e.current=s.sent();this.currentPlaylistItem.playing=true;i=this;return[4,this.currentPlaylistItem.details()];case 3:i.currentTrack=s.sent();return[2]}}))}))};t.prototype.play=function(t){if(t===void 0){t=false}return __awaiter(this,void 0,void 0,(function(){var e,i,s,r;return __generator(this,(function(n){switch(n.label){case 0:if(!t){this.currentTrack={title:"Loading...",artist:"One sec...",picture:undefined}}this.loading=true;this.playing=true;return[4,this.audio.play()];case 1:n.sent();if(!!this.context)return[3,3];e=new(window.AudioContext||window.webkitAudioContext);i=e.createMediaElementSource(this.audio);return[4,this.visualizer.connect(e)];case 2:s=n.sent();i.connect(s.analyser);s.analyser.connect(e.destination);this.context=e;n.label=3;case 3:r=this;return[4,this.currentPlaylistItem.details()];case 4:r.currentTrack=n.sent();this.loading=false;return[2]}}))}))};t.prototype.pause=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:if(!!this.audio.paused)return[3,2];this.playing=false;return[4,this.audio.pause()];case 1:t.sent();return[3,4];case 2:this.playing=true;return[4,this.audio.play()];case 3:t.sent();t.label=4;case 4:return[2]}}))}))};t.prototype.next=function(){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:t=this.element.querySelector("stellar-song[playing]");if(this.current===this.playlistItems.length-1){t=this.element.querySelector("stellar-song:first-child")}else{t=t.nextElementSibling}return[4,t.play()];case 1:e.sent();return[2]}}))}))};t.prototype.previous=function(){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(e){t=this.element.querySelector("stellar-song[playing]");t.removeAttribute("playing");if(this.current===0){t=this.element.querySelector("stellar-song:last-child")}else{t=t.previousElementSibling}t.setAttribute("playing",true);t.play();return[2]}))}))};t.prototype.togglePlaylist=function(){if(this.playlist==="show"){this.playlist="hide"}else{this.playlist="show"}localStorage.setItem("playlist",this.playlist)};t.prototype.toggleAlbumArtView=function(){if(this.view==="playlist"){this.view="art"}else{this.view="playlist"}};t.prototype.handlePlay=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){if(!this.load){this.load=true;this.load_songs.emit({})}this.pause();return[2]}))}))};t.prototype.render=function(){var t=this;return s("div",{id:"player"},s("div",{class:"playlist-title"},s("h6",null,this.name),s("button",{class:"playlist",onClick:function(){return t.togglePlaylist()}},s("h6",{class:"list"},s("stellar-asset",{name:"musical-notes"}),"list")),s("button",{class:"switch-view",onClick:function(){return t.toggleAlbumArtView()},"data-playing":this.playing},s("h6",{class:"list"},this.view==="art"?s("stellar-asset",{name:"albums"}):s("stellar-asset",{name:"radio"}),this.view==="art"?"Art":"Player")),s("stellar-color-picker",{val:this.visualizationColor,notransparent:true,onUpdate:function(e){t.visualizationColor=e.detail}})),s("div",{class:"playlist-playing"},s("button",{onClick:function(){t.handlePlay()},class:"toggle-button","data-playing":this.playing},this.playing?s("stellar-asset",{name:"pause"}):s("stellar-asset",{name:"play"})),!this.load&&s("stellar-button",{tag:"button",size:"tiny",onClick:function(){t.load=true;t.load_songs.emit({})}},"Load ",this.name||"this playlist"),this.load&&s("div",{class:"playlist-playing-details"},s("h2",null,this.currentTrack.title||"Loading..."),s("h3",null,this.currentTrack.artist||"One Sec...")),this.load&&s("div",{class:"playlist-playing-image"},this.loading&&s("stellar-progress",{indeterminate:true}),!this.loading&&this.currentTrack.picture!==undefined&&s("img",{src:this.currentTrack.picture,onClick:function(){return t.toggleAlbumArtView()}})),!this.load&&this.currentTrack.picture===undefined&&s("skeleton-img",{width:1024,height:1024,block:true,loading:true}),s("web-audio-visualizer",{type:this.visualizationType,color:this.visualizationColor,onClick:function(){t.cycleVisualizations()},width:1024,height:this.view==="art"?1024:256}),s("div",{class:"playlist-progress "+(this.load?"load":"noload")},s("h6",{id:"currentTime"},this.currentTime),s("h6",{id:"totalTime"},this.duration),s("progress",{id:"progress",max:"100",value:this.progress_value}))),s("div",{id:"controls",class:"controls"},s("button",{onClick:function(){return t.previous()},class:"button previous"},s("stellar-asset",{name:"skip-backward"})),s("button",{onClick:function(){return t.next()},class:"button next"},s("stellar-asset",{name:"skip-forward"}))),s("audio",{id:"playlist-audio",preload:"auto",tabindex:"0",controls:true},s("source",{id:"source",type:"audio/mp3"})),s("div",{id:"playlist",class:"playlist-list "+this.playlist},this.load&&s("slot",null)))};Object.defineProperty(t.prototype,"element",{get:function(){return r(this)},enumerable:true,configurable:true});Object.defineProperty(t,"style",{get:function(){return":host,:host *{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-box-sizing:border-box;box-sizing:border-box}:host{--color-one:var(--theme-base1);--color-two:var(--theme-base9);--color-three:var(--theme-base5);--color-four:var(--theme-base7);--color-bg:var(--theme-base0);--color-bg-active:var(--theme-base1);--color-bg-playing:var(--theme-base2);--color-line:var(--theme-base1)}:host([dark]){--color-one:var(--theme-base9);--color-two:var(--theme-base1);--color-three:var(--theme-base7);--color-four:var(--theme-base2);--color-bg:var(--black-alt);--color-bg-active:var(--theme-base8);--color-bg-playing:var(--theme-base8);--color-line:var(--black)}:host{display:block;-webkit-box-sizing:border-box;box-sizing:border-box;background:var(--color-bg);max-width:650px;width:100%;margin:0 auto}:host button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:none;outline:0;border:0;cursor:pointer}:host button.playlist{margin:0 .5rem 0 auto}:host button.switch-view{margin:0 .5rem 0 0}:host audio{display:none}:host #player{position:relative}:host stellar-color-picker{z-index:99}:host web-audio-visualizer{height:0;margin-top:1rem;opacity:0;-webkit-transition:all .25s var(--ease) 0s;transition:all .25s var(--ease) 0s;width:100%}:host([playing]) web-audio-visualizer{opacity:1;height:10rem}:host h6{font-size:.75rem;margin:0;text-transform:uppercase;color:var(--color-two);letter-spacing:.23em;z-index:1}:host h6.list{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}:host h6.list stellar-asset{margin-right:.5rem}:host .playlist-playing,:host .playlist-playing-details,:host .playlist-progress,:host .playlist-title{-webkit-transition:all .1875s ease-in-out 0s;transition:all .1875s ease-in-out 0s}:host .playlist-playing-image{-webkit-transition:all .25s ease-in-out 0s;transition:all .25s ease-in-out 0s}:host .playlist-title{background:var(--color-one);height:3rem;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;padding:.5rem 1rem}:host .playlist-playing-details{margin-right:30px}:host .playlist-playing{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-align:center;align-items:center;padding:2rem 1rem 3rem;position:relative}:host .playlist-playing h2,:host .playlist-playing h3{font-weight:400;margin:0}:host .playlist-playing h2{color:var(--color-two);font-weight:700;font-size:17px;overflow:hidden;width:100%}:host .playlist-playing h3{color:var(--color-four);font-size:16px;overflow:hidden;width:100%}:host .playlist-progress{display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:baseline;align-items:baseline;-ms-flex-pack:justify;justify-content:space-between;width:100%;padding:0 15px 15px;z-index:5;bottom:0;left:0;-webkit-transition:all .1s ease 0s;transition:all .1s ease 0s;opacity:0;-webkit-transform:translateY(-10px);transform:translateY(-10px);max-height:0}:host .playlist-progress.load{opacity:1;-webkit-transform:translateY(0);transform:translateY(0);max-height:100px}:host .playlist-progress progress{-webkit-appearance:none;-moz-appearance:none;appearance:none;position:absolute;height:3px;bottom:0;left:0;width:100%;-webkit-transition:all 75ms ease-in-out .25s;transition:all 75ms ease-in-out .25s;cursor:pointer;z-index:2}:host .playlist-progress progress:hover{-webkit-transition:all 75ms ease-in-out 0s;transition:all 75ms ease-in-out 0s;height:16px;bottom:-8px}:host .playlist-progress progress[value]::-moz-progress-bar{background-color:var(--color-line)}:host .playlist-progress progress[value]::-webkit-progress-bar{background-color:var(--color-line)}:host .playlist-progress progress[value]::-webkit-progress-value{background-color:var(--color-three)}:host .playlist-list{max-height:24rem;overflow:auto;-webkit-transition:all .2s ease 0s;transition:all .2s ease 0s}:host .playlist-list.hide{max-height:0}:host .controls{display:-ms-flexbox;display:flex;display:none;margin:1em 0}:host .controls .button{font-size:2rem;width:50%;-ms-flex:12 6 200px;flex:12 6 200px}:host .controls .button stellar-asset{display:inline-block}:host .playlist-playing-image{margin:auto 0 auto auto;width:5rem;-ms-flex:0 0 5rem;flex:0 0 5rem;height:5rem;cursor:pointer}:host .playlist-playing-image img{width:100%;background:#fff;border-radius:3px;height:auto;-webkit-box-shadow:0 3px 3px 0 hsla(0,0%,91%,.6);box-shadow:0 3px 3px 0 hsla(0,0%,91%,.6)}:host .playlist-playing .toggle-button{padding:0;margin-right:2rem;width:3rem;height:3rem;padding:14px;border-radius:100%;background:var(--color-three);color:#fff;position:relative}:host .playlist-playing .toggle-button stellar-asset{font-size:2rem;position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}:host .playlist-playing .toggle-button stellar-asset[name=play]{-webkit-transform:translate(-43%,-50%);transform:translate(-43%,-50%)}:host .playlist-playing .toggle-button[data-playing=false]{padding:14px 12px 14px 16px}:host .st0{fill:var(--color-three)}:host .st1{fill:#fff}:host skeleton-img{display:none}:host([view=art]) .playlist-playing{position:relative;margin:0;padding:0;overflow:hidden}:host([view=art]) web-audio-visualizer{height:100%;position:absolute;bottom:0;z-index:2;-webkit-transition:all 0s var(--ease) 0s;transition:all 0s var(--ease) 0s}:host([view=art]) .playlist-playing .toggle-button{display:none}:host([view=art]) .playlist-playing .playlist-playing-details{position:absolute;bottom:0;width:100%;padding:2rem;background:var(--color-one);left:0;right:0;text-align:center;mix-blend-mode:hard-light;margin:0;-webkit-transform:translateY(100%);transform:translateY(100%);z-index:3}:host([view=art]:hover) .playlist-playing-details{-webkit-transform:translateY(0);transform:translateY(0)}:host([view=art]) .playlist-progress{padding:0 15px 0}:host([view=art]) .playlist-progress h6{display:none}:host([view=art]) .playlist-playing stellar-button{position:absolute;left:50%;top:50%;z-index:3;-webkit-transform:translate(-50%,-50%)!important;transform:translate(-50%,-50%)!important}:host([view=art]) .playlist-playing-image,:host([view=art]) skeleton-img{display:block;width:100%;margin:0 auto;-ms-flex:none;flex:none;height:0;padding-bottom:100%}:host([view=art]) .playlist-playing-image:focus,:host([view=art]) .playlist-playing-image:hover{-webkit-transform:scale(1.025);transform:scale(1.025);cursor:pointer}:host([view=art]) .playlist-playing-image img{width:100%}:host([view=art]) .controls{display:none}:host([dark]) .playlist-playing-image img{-webkit-box-shadow:0 3px 3px 0 rgba(24,24,24,.6);box-shadow:0 3px 3px 0 rgba(24,24,24,.6)}:host([dark]) web-audio-visualizer{-webkit-filter:hue-rotate(180deg) invert(80%);filter:hue-rotate(180deg) invert(80%)}"},enumerable:true,configurable:true});return t}());a.injectProps(l,["dark"])}}}));